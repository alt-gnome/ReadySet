polkit.addRule(function(action, subject) {
    if (subject.user !== "_greeter")
        return;

    var actionMatches =
        action.id.indexOf("org.freedesktop.accounts.") === 0 ||
        action.id.indexOf("com.endlessm.ParentalControls.") === 0 ||
        (action.id === "org.freedesktop.policykit.exec" &&
         action.lookup("program") == "@LIBEXECDIR@/ready-set-set-root-password");

    if (actionMatches) {
        if (subject.local)
            return polkit.Result.YES;
        else
            return polkit.Result.AUTH_ADMIN;
    }

    return;
});
